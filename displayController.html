<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Presentation</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
	<script>
		//constants (set here, never changed)
		var controlSpreadsheetID = "1_tZYpivy2TbIwTx8rd7GNzyCgUNhev45xMxQqdN3Njw"; 
		var updateIntervalMinutes = 1;
		var displayLocation=GetUrlParam('location');
		if (displayLocation == null)
			displayLocation="test";
		var timerID = setInterval(checkForPageChange, updateIntervalMinutes*60*1000);		
		
		//variable (updated in checkForPageChange())
		var currentPageURL="";			
		
		//-------------------------------------------
		$(document).ready(function()
		{ 
			checkForPageChange();			
		}); //doc.ready()
		
		//-----------------------------------------
		function checkForPageChange() {
			var controlDataURL = "https://spreadsheets.google.com/feeds/list/" 
				+ controlSpreadsheetID + "/od6/public/values?alt=json";
		
			$.getJSON(controlDataURL, function(data) {
				$(data.feed.entry).each(function() {
					//note: first line (headings) is automatically skipped
					//get URL
					var newURL = "";
					if (typeof this.gsx$location !== 'undefined' && trim(this.gsx$location.$t).length>1 
					 && typeof this.gsx$url !== 'undefined' && trim(this.gsx$url.$t).length>1
					 && this.gsx$location == displayLocation ) {
						newURL=this.gsx$url.$t;
						if (newURL != currentPageURL) {
							currentPageURL = newURL;
							document.getElementById("show").src = currentPageURL;
						}
					}
 				}); //each
			});//getJSON
		} //checkForPageChange()	
		
		//-----------------------------------------
		// get specified URL parameter
		function GetUrlParam(name){
    			var results = new RegExp('[\\?&]' + name + '=([^&#]*)').exec(window.location.href);
			if (results != null)
				return results[1];
			else
				return null;
		}
	</script>
</head>

<body>

<iframe 
	id="show" 
	style="position:fixed; top:0px; left:0px; bottom:0px; right:0px; width:100%; height:100%; border:none; margin:0; padding:0; overflow:hidden; z-index:100;"
>
	Loading Page ....
</iframe>

</body>

</html>
